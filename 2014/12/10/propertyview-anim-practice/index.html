<!DOCTYPE html><html lang="zh-Hans"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>动画系列 - PropertyAnim 实际应用 | lightSky'Blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">动画系列 - PropertyAnim 实际应用</h1><a id="logo" href="/.">lightSky'Blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Inicio</i></a><a href="/archives/"><i class="fa fa-archive"> Archivo</i></a><a href="/about/"><i class="fa fa-user"> Acerca de</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">动画系列 - PropertyAnim 实际应用</h1><div class="post-meta">Dec 10, 2014<span> | </span><span class="category"><a href="/categories/Android/">Android</a><a href="/categories/Android/Android动画/">Android动画</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2014/12/10/propertyview-anim-practice/" href="/2014/12/10/propertyview-anim-practice/#comments" class="ds-thread-count"></a><div class="post-content"><p>通过前一篇文章的分析，我们知道在使用Animator的时候，会为你传入的参数值设定一个time fraction，这个time fraction是根据参数平分的，具体可以参考KeyframeSet赋值的那一部分。每一个参数值在到达对应的时间点的时候，其动画值都会达到该参数值，也就会出现拐点，我们可以利用这种表现，来实现不同的动画效果。<br><a id="more"></a></p>
<p>对于Translate，Alpha，Scale，Rotate这几种动画的一些属性的使用这里具体说明下，旋转和渐变就一笔带过，使用很简单。</p>
<p>在Property 动画中，所有的动画属性是相同的，参数值只有ValueFrom 和ValueTo的概念，0则表示目标位置（TargetView布局时的位置）。某一方向的动画是直接通过动画名称来标注的。比如Translate动画分为 TranslateX和TranslateY。直接标明是X和Y轴的动画：</p>
<p>参数中的0表示目标位置。之前的一系列赋值都是动画值，最后一个通常设置为0，表示动画结束时Target到达布局中设置的位置。</p>
<p>##Translate##<br>对应的属性名为TranslateX和TranslateY</p>
<p>TranslateX：参考轴为Y轴<br>如果value &lt; 0 则位于Y轴的左侧。<br>如果value &gt; 0 则位于Y轴的右侧。</p>
<p>TranslateY：参考轴为X轴<br>如果value &lt; 0 则位于X轴的下方。<br>如果value &gt; 0 则位于X轴的上方。</p>
<p>##Scale##<br>对应的属性名为 ScaleX、ScaleY<br>android:pivotX<br>android:pivotY<br>value 为缩放比例</p>
<p>##Rotate：对于的属性名为rotation##<br> android:pivotX 旋转中心X坐标<br> android:pivotY 旋转中心Y坐标<br> rotation: value 为旋转角度<br> value &gt; 0 在参考位置的顺时针方向<br> value &lt; 0 在参考位置的逆时针方向<br> 如果不设置privotX和privotY，默认是Target的中心为缩放坐标</p>
<p>ObjectAnimator.ofFloat(target, “rotation”, -90, 0),<br>ObjectAnimator.ofFloat(target, “pivotX”, x, x),<br>ObjectAnimator.ofFloat(target, “pivotY”, y, y)<br>这里从逆时针方向90度以X和Y为中心坐标，旋转到目标位置<br>为了整个过程的时序上保持一致。所以这里privotX和privotY与rotation的参数都为2，旋转中心始终不变</p>
<p>##Alpha##<br>0.0表示完全透明，1.0表示完全不透明，Float值。<br>这个动画比较简单，只是使用的时候，参数值的设置，可以达到不同的效果。<br>比如Bling Bling的效果：<br>ObjectAnimator.ofFloat(target,”alpha”,1,0,1,0,1)</p>
<p>更直观的，通过图示的方式来看一下：</p>
<p>##translateX value &lt; 0 ##<br><img src="/img/property-view-practice/anim1.png">   </p>
<p>##translateY value &gt; 0 ##<br><img src="/img/property-view-practice/anim2.png">   </p>
<p>##rotate 90度 - 0度##<br><img src="/img/property-view-practice/anim3.png"><br><img src="/img/property-view-practice/anim4.png">   </p>
<p>如果你希望在不同值之间会有一些速率变化的效果，那么就可以考虑使用插值器了。<br>如果你明白了上述的工作方式，并且想接触更多的动画效果，你可以参考代码家的<a href="https://github.com/daimajia/AndroidViewAnimations" target="_blank" rel="external">AndroidViewAnimations</a> 动画库，里面封装了各种样式的动画效果,偷图如下：<br><img src="/img/property-view-practice/anim5.gif" height="410" width="320">   </p>
<p>以上的动画的编排还算是简单的，如何将多个动画组合在一起，实现酷炫的效果呢？<br>大家也可以感觉到，现在的APP导航界面越来越多的使用了动画效果，让人觉得眼前一亮，撩起用户的使用欲望。GitHub上有两个演示项目，一个是仿墨迹天气的，一个是仿新浪微博的。之前之所以没有直接介绍，是因为我觉得动画这方面的知识不能说相当重要，但是以后开发中一定少不了。对于这样的知识那就一次性搞懂吧。掌握了动画的原理和使用，就看产品怎么定需求了。</p>
<p>我们来看一下，两种导航页的效果：<br>注：两个Demo都没有向3.0之前兼容，如果要兼容，使用<a href="https://github.com/JakeWharton" target="_blank" rel="external">JakeWharton</a> 大神的<a href="https://github.com/JakeWharton/NineOldAndroids" target="_blank" rel="external">NineOldAndroids</a> 即可</p>
<p><a href="https://github.com/kongnanlive/AndroidAnimationDemo" target="_blank" rel="external">https://github.com/kongnanlive/AndroidAnimationDemo</a><br><a href="http://v.youku.com/v_show/id_XNzc0MTgxMDg4.html" target="_blank" rel="external">http://v.youku.com/v_show/id_XNzc0MTgxMDg4.html</a><br><img src="/img/property-view-practice/anim7.gif">   </p>
<p><a href="https://github.com/xyzhang/mojichina" target="_blank" rel="external">https://github.com/xyzhang/mojichina</a><br><img src="/img/property-view-practice/anim6.gif">   </p>
<p>在 kongnanlive Weibo示例中由于整个界面的动画比较多，每一个动画又比较复杂，这里代码的思路是每一个单个的动画使用了PropertyValuesHolder，PropertyValuesHolder，相对于AnimationSet.playTogether来实现更简便，减少了ObjectAnimator的创建。<br>而最终整个界面的所有动画并发执行的时候，使用AnimatorSet.playTogether(…); 每一个界面使用一个AnimationSet统一管理所有的动画。同时为了及时释放资源，通过onLeft onRight onLeftEnd onRightEnd 来处理动画的状态。</p>
<p>再简单说下：<br>PropertyValuesHolder含有的工厂方法有ofFloat(String propertyName, float… values)、ofKeyframe(String propertyName, Keyframe… values)等。Keyframe的构造方法为Keyframe(fraction,value)，包含了fraction和value。fraction系统会根据上层传入的value个数计算得到。该项目主要使用了上述两个工厂方法，两种方式效果相同，只是ofKeyframe(String propertyName, Keyframe… values)需要自己创建Keyframe，而ofFloat，只需传入值，fraction由系统计算出。<br>如果有不明白的朋友，可以看下<a href="http://blog.csdn.net/xushuaic/article/details/40424379" target="_blank" rel="external">Property Anim详解</a> 中的KeyframeSet.java源码分析部分.</p>
<p>xyzhang 的moji，更简洁些。全部使用的是系统自带的View，看起来更加容易些。<br>两个项目都是可以作为拓展思路的好项目，大家有空可以研究研究。</p>
<p>kongnanlive：微博：<a href="http://weibo.com/kongnan?from=feed&amp;loc=at&amp;nick=%E7%BD%91%E6%98%93%E5%AD%94%E6%A5%A0" target="_blank" rel="external">网易孔楠</a><br>xyzhang：微博：<a href="http://www.weibo.com/xyzlmn" target="_blank" rel="external">张兴业TBOW</a></p>
<p>##GitHub上的一些动画项目：##<br>这些动画效果，还是比较简单的，使用代码家的<a href="https://github.com/daimajia/AndroidViewAnimations" target="_blank" rel="external">AndroidViewAnimations</a> 动画库基本都可实现，只是Target不同而已。所以掌握了原理，动画都是一样的。</p>
<p><a href="https://github.com/pedant/sweet-alert-dialog" target="_blank" rel="external">https://github.com/pedant/sweet-alert-dialog</a></p>
<p><img src="/img/property-view-practice/anim8.gif" height="410" width="320">   </p>
<p><a href="https://github.com/sd6352051/NiftyNotification" target="_blank" rel="external">https://github.com/sd6352051/NiftyNotification</a></p>
<p><img src="/img/property-view-practice/anim9.png" height="410" width="320">   </p>
<p><a href="https://github.com/sd6352051/NiftyDialogEffects" target="_blank" rel="external">https://github.com/sd6352051/NiftyDialogEffects</a></p>
<p><img src="/img/property-view-practice/anim10.png" height="410" width="320">   </p>
<p>###感受：###<br>通过完整的分析Android的动画之后，发现写一篇好的博客确实不容易，特别是希望能用浅显的方式和大家讲述的时候，本来自己看的，可以将就，但分享的时候，要以最好的方式呈现给大家，整个原理分析部分也是花了不少时间，总是希望整篇文章更全面、更有逻辑性。不过回过头看，确实收获了很多，也是自己第一篇对某方面知识这么全面和系统的分析。也收获了不少认可，算是成功的吧。<br>对于动画的原理分析告一段落了。拥有了这些知识，分析动画项目也更容易了，以后会陆续分析一些动画项目，其它形式的动画，比如ViewPager的动画。请大家敬请期待。</p>
<p>GitHub：<a href="https://github.com/lightSky" target="_blank" rel="external">lightSky</a><br>微博：    <a href="http://www.weibo.com/lightSkyStreet" target="_blank" rel="external">light_sky</a>  爱Android，爱开源，爱分享,爱运动，欢迎交流</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://www.lightskystreet.com/2014/12/10/propertyview-anim-practice/" data-id="civlq5ryl0035ozcaz5rv95ch" class="article-share-link">Cuota</a><div class="tags"><a href="/tags/PropertyViewAnim/">PropertyViewAnim</a></div><div class="post-nav"><a href="/2014/12/14/new-blog-site/" class="pre">搬家了</a><a href="/2014/12/09/viewpagerindicator-analysis/" class="next">ViewPagerindicator 源码解析</a></div><div data-thread-key="2014/12/10/propertyview-anim-practice/" data-title="动画系列 - PropertyAnim 实际应用" data-url="http://www.lightskystreet.com/2014/12/10/propertyview-anim-practice/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2014/12/10/propertyview-anim-practice/" data-title="动画系列 - PropertyAnim 实际应用" data-url="http://www.lightskystreet.com/2014/12/10/propertyview-anim-practice/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://www.lightskystreet.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categorías</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android动画/">Android动画</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/MaterialDesign/">MaterialDesign</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/优秀项目原理解析/">优秀项目原理解析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/性能优化/">性能优化</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/编译/">编译</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android最佳实践/">Android最佳实践</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/">JS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/RN/">RN</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reactive/">Reactive</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Rx/">Rx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Talk/">Talk</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Etiquetas</i></div><div class="tagcloud"><a href="/tags/MaterialDesign/" style="font-size: 15px;">MaterialDesign</a> <a href="/tags/Android，性能优化/" style="font-size: 15px;">Android，性能优化</a> <a href="/tags/Android，架构/" style="font-size: 15px;">Android，架构</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Anim/" style="font-size: 15px;">Anim</a> <a href="/tags/Android，适配/" style="font-size: 15px;">Android，适配</a> <a href="/tags/Android动画/" style="font-size: 15px;">Android动画</a> <a href="/tags/Android，最佳实践/" style="font-size: 15px;">Android，最佳实践</a> <a href="/tags/优秀项目原理解析/" style="font-size: 15px;">优秀项目原理解析</a> <a href="/tags/JS学习笔记/" style="font-size: 15px;">JS学习笔记</a> <a href="/tags/性能优化/" style="font-size: 15px;">性能优化</a> <a href="/tags/Android，编译/" style="font-size: 15px;">Android，编译</a> <a href="/tags/Android，原理解析/" style="font-size: 15px;">Android，原理解析</a> <a href="/tags/Rx/" style="font-size: 15px;">Rx</a> <a href="/tags/PropertyViewAnim/" style="font-size: 15px;">PropertyViewAnim</a> <a href="/tags/RN/" style="font-size: 15px;">RN</a> <a href="/tags/Reactive/" style="font-size: 15px;">Reactive</a> <a href="/tags/Rexactive/" style="font-size: 15px;">Rexactive</a> <a href="/tags/ViewAnim/" style="font-size: 15px;">ViewAnim</a> <a href="/tags/ViewPager/" style="font-size: 15px;">ViewPager</a> <a href="/tags/View绘制机制/" style="font-size: 15px;">View绘制机制</a> <a href="/tags/PropertyAnim，源码分析/" style="font-size: 15px;">PropertyAnim，源码分析</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recientes</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/11/11/android-dex-plugin/">multidex与插件化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/19/android-optimize-image-download-size/">Android性能优化-减小图片下载大小</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/18/android-optimize-thread/">Android性能优化-线程性能优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/android-optimize-apk/">Android性能优化-减小APK大小</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/android-optimize-memory/">Android性能优化-内存优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/android-optimize-background/">Android性能优化-App后台优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/android-optimize-start/">Android性能优化-App启动优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/16/js-str-arr/">JS学习-字符串和数组</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/13/js-inherit/">JS学习-封装和继承</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/08/js-func/">JS学习-函数</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> Comentarios recientes</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">lightSky'Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'lightSky'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-57428802-1## Your Google Analytics tracking id, e.g. UA-42425684-2','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>